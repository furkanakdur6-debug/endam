<script>
async function sendToBot(){
  const input = document.getElementById("botInput");
  const messages = document.getElementById("botMessages");
  const text = input.value.trim();
  if(!text) return;

  messages.innerHTML += `<div><b>Sen:</b> ${text}</div>`;
  input.value = "";
  messages.scrollTop = messages.scrollHeight;

  try{
    const res = await fetch("/.netlify/functions/endam-bot", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });

    const data = await res.json();

    if(!res.ok){
      messages.innerHTML += `<div><b>Endam Bot:</b> Hata: ${JSON.stringify(data)}</div>`;
    }else{
      messages.innerHTML += `<div><b>Endam Bot:</b> ${data.reply}</div>`;
    }
  }catch(err){
    messages.innerHTML += `<div><b>Endam Bot:</b> BaÄŸlantÄ± hatasÄ± ðŸ˜…</div>`;
  }

  messages.scrollTop = messages.scrollHeight;
}
</script>
